<!DOCTYPE html>
<html>
<head>
    <title>Reset Ratings</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <h1>Resetting Firebase Ratings...</h1>
    <div id="status"></div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA9-6V0dYFZIIuGMSe7Uu0SiNBITrMG3uk",
            authDomain: "bar-sjokefactory.firebaseapp.com",
            projectId: "bar-sjokefactory",
            storageBucket: "bar-sjokefactory.firebasestorage.app",
            messagingSenderId: "1084220751714",
            appId: "1:1084220751714:web:aba8758a48d0d2c735763b"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        async function deleteAllRatings() {
            const status = document.getElementById('status');
            try {
                const snapshot = await db.collection('ratings').get();
                status.innerHTML = `Found ${snapshot.size} documents to delete...<br>`;
                
                const batch = db.batch();
                snapshot.docs.forEach(doc => {
                    batch.delete(doc.ref);
                });
                
                await batch.commit();
                status.innerHTML += 'All ratings deleted from Firebase!<br>';
                
                // Clear localStorage too
                localStorage.removeItem('myJokeRatings');
                localStorage.removeItem('jokeRatings');
                status.innerHTML += 'Local ratings cleared!<br>';
                status.innerHTML += '<br><strong>Done! You can close this page.</strong>';
            } catch (error) {
                status.innerHTML = 'Error: ' + error.message;
            }
        }

        deleteAllRatings();
    </script>
</body>
</html>
